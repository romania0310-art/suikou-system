# 横浜市立長津田小学校 通知表所見推敲システム

## プロジェクト概要
- **名称**: 通知表所見推敲システム（あゆみ表記ルール対応版）
- **目的**: 先生方が作成する通知表の「所見」を「あゆみ表記ルール.pdf」および文化審議会建議「公用文作成の考え方」に基づいて自動推敲するシステム
- **機能**: CSVファイルの一括アップロード、自動推敲、修正前後比較、修正版CSVダウンロード、適用ルール詳細表示

## 公開URL
- **開発環境**: https://3000-il502d2bzfgk1buxofcft-6532622b.e2b.dev
- **GitHub**: （デプロイ後に更新）

## データ設計
- **データベース**: Cloudflare D1 (SQLite)
- **主要テーブル**:
  - `classes`: クラス情報（学年、クラス番号、担任名）
  - `students`: 児童情報（出席番号、氏名）
  - `review_sessions`: 推敲セッション管理（CSV一括処理用）
  - `student_reports`: 所見データ（元文、推敲後文、推敲メモ）

## 推敲ルール（あゆみ表記ルール + 文化審議会建議準拠）
### 1. あゆみ表記ルール（PDFファイル準拠）
- **ひらがな表記**: 「気持ち」→「きもち」、「取組」→「とりくみ」、「仲良く」→「なかよく」
- **漢字表記**: 「あいさつ」→「挨拶」、「あらわす」→「表す」、「いかす」→「生かす」
- **表現統一**: 「お年寄り」→「高齢者」、「子供」→「こども」

### 2. 公用文推敲ルール（文化審議会建議準拠）
- **口語的表現の正式化**: 「とても」→「非常に」、「ちゃんと」→「適切に」
- **学校用語の正式化**: 「みんなの前で」→「学級において」、「お話」→「物語」、「勉強」→「学習」
- **能力表現の客観化**: 「上手」→「優れている」、「得意」→「高い能力を示している」
- **評価表現の標準化**: 「とても良い」→「優れている」、「できるけど」→「できるが」
- **文体の統一**: 普通語から丁寧語（です・ます調）への変換
- **語尾・接続の調整**: 不自然な表現や重複の修正

## 使用方法
1. **CSVアップロード**: 「学年」「組」「番号」「所見等（推敲したい文）」列（複数対応）を含むCSVファイルをアップロード
2. **自動推敲**: あゆみ表記ルールと文化審議会建議に基づく自動推敲処理（複数所見個別処理）
3. **結果確認**: 修正前後の比較表示で変更内容と適用ルールを確認
4. **ダウンロード**: 推敲済みの所見データをCSVファイルとしてダウンロード（所見種別付き）

## 技術スタック
- **フレームワーク**: Hono (Edge-first Web Framework)
- **ランタイム**: Cloudflare Workers
- **データベース**: Cloudflare D1 (SQLite)
- **フロントエンド**: Vanilla JavaScript + Tailwind CSS + FontAwesome
- **開発環境**: Vite + TypeScript
- **プロセス管理**: PM2

## デプロイ状況
- **開発環境**: ✅ 稼働中
- **本番環境**: ⏳ 準備中
- **最終更新**: 2025年8月20日 - 複数所見対応完了（所見-1、所見-2の個別推敲処理）

## ファイル構造
```
webapp/
├── src/
│   ├── index.tsx          # メインアプリケーション
│   ├── renderer.tsx       # HTMLレンダリング
│   └── ayumi-rules.ts     # あゆみ表記ルール定義
├── public/static/
│   ├── app.js            # フロントエンド機能
│   └── style.css         # カスタムスタイル
├── migrations/
│   └── 0001_initial_schema.sql # データベーススキーマ
├── ecosystem.config.cjs   # PM2設定
├── wrangler.jsonc        # Cloudflare設定
├── sample_new_format.csv # 実際の運用形式サンプルデータ（学年・組・番号・所見等）
├── sample.csv            # テスト用サンプルデータ（旧形式・児童名・教科・所見）
└── sample_ayumi.csv      # テスト用サンプルデータ（あゆみ表記ルール検証用）
```

## サンプルCSV形式（実際の運用形式・複数所見対応）
```csv
学年,組,番号,所見等（推敲したい文）-1,2 所見等（推敲したい文）-2
5,1,1,国語の物語学習では、登場人物の心情をていねいに読み取り、言葉の意味や表現に着目して自分の考えを深めている。,算数の図形の学習では、辺の長さや角の大きさの相等に気をつけて、図形の性質を論理的に捉えることができます。
5,1,2,体育のハードル走では、リズムを意識して軽やかに走る姿が見られます。,
5,1,3,様々な教科で、子供らいしく課題に対してじっくり考え、確かな学びを積み重ねています。,今後も持ち味を生かして頑張ってください。
```

## 主な表記変換例
| 変換前 | 変換後 | ルール種別 |
|--------|--------|------------|
| とても | 非常に | 公用文推敲 |
| お話 | 物語 | 学校用語正式化 |
| 勉強 | 学習 | 学校用語正式化 |
| なかよく | 仲よく | あゆみ表記（正用表記） |
| 子供 | 子ども | あゆみ表記（正用表記） |
| 私達 | 私たち | あゆみ表記（正用表記） |
| あいさつ | 挨拶 | あゆみ表記（漢字） |
| である調 | です・ます調 | 文体統一 |

## 推敲例（あゆみ表記ルール適用）
### 例1: 基本的な表記統一と公用文化
**修正前**: 「読解力がとても良くて、作文も上手に書けています。漢字の勉強もがんばっています。」
**修正後**: 「読解力が非常に良く、作文も上手に書くことができます。漢字の学習も意欲的に取り組んでいます。」
**適用ルール**: 口語表現を公用文表現に、学校用語の正式化、文体統一（です・ます調）

### 例2: あゆみ表記ルール（正用表記統一）
**修正前**: 「友達ともなかよく話し合っています。私達も応援しています。子供らしい発想です。」
**修正後**: 「友達とも仲よく話し合っています。私たちも応援しています。子どもらしい発想です。」
**適用ルール**: 「なかよく」→「仲よく」、「私達」→「私たち」、「子供」→「子ども」、文体統一（です・ます調）

## 管理者情報
- **開発者**: 横浜市立長津田小学校校長
- **メール**: principal@nagatsuta-es.yokohama.jp
- **更新履歴**: Git管理による変更履歴追跡